{% extends "base.html" %}
{% load static %}
{% block title %}Inicio{% endblock %}

{% block content %}
<style>
  .home-wrap{
    max-width:1100px;
    margin:24px auto;
    display:grid;
    gap:20px;
    grid-template-columns:1.2fr .8fr;
  }
  .card{
    background:#1f2937;
    border:1px solid #334155;
    border-radius:12px;
    padding:16px;
  }
  .card h2{
    margin:0 0 12px 0;
    color:#a78bfa;
    font-size:1.1rem;
    display:flex;
    align-items:center;
    gap:6px;
  }
  .selector{
    margin-bottom:12px;
  }
  .selector label{
    margin-right:.5rem;
  }
  .selector select{
    background:#0f172a;
    color:#e5e7eb;
    border:1px solid #334155;
    border-radius:8px;
    padding:6px 10px;
  }
  table.stand{
    width:100%;
    border-collapse:collapse;
    font-size:.95rem;
  }
  table.stand th,
  table.stand td{
    border-bottom:1px solid #2b3344;
    padding:8px 10px;
    text-align:left;
  }
  table.stand th{
    color:#cbd5e1;
    font-weight:600;
  }
  table.stand tbody tr:nth-child(even){
    background:#111827;
  }
  .muted{
    color:#94a3b8;
    font-size:.9rem;
  }
  .news-item{
    border-bottom:1px solid #2b3344;
    padding:10px 0;
  }
  .news-item:last-child{
    border-bottom:none;
  }
  .news-item-title{
    font-weight:600;
    margin-bottom:4px;
  }
  .news-meta{
    font-size:.85rem;
    color:#9ca3af;
    margin-bottom:4px;
  }
  @media (max-width: 980px){
    .home-wrap{grid-template-columns:1fr;}
  }
</style>

<div class="home-wrap">

  <!-- TABLA DE POSICIONES POR SERIE -->
  <section class="card">
    <h2>üèÜ Tabla de posiciones por serie</h2>

    <form class="selector" method="get">
      <label for="id_serie">Serie:</label>
      <select id="id_serie" name="id_serie" onchange="this.form.submit()">
        {% for s in series %}
          <option value="{{ s.id }}" {% if s.id|stringformat:'s' == id_serie|stringformat:'s' %}selected{% endif %}>
            {{ s.etiqueta }}
          </option>
        {% endfor %}
      </select>
    </form>

    {% if serie_sel %}
      <p class="muted">
        Mostrando posiciones para la serie:
        <strong>{{ serie_sel.etiqueta }}</strong>
      </p>
    {% endif %}

    {% if posiciones %}
      <table class="stand">
        <thead>
          <tr>
            <th>#</th>
            <th>Club</th>
            <th>Pts</th>
            <th>PJ</th>
            <th>PG</th>
            <th>PE</th>
            <th>PP</th>
            <th>GF</th>
            <th>GC</th>
            <th>DG</th>
          </tr>
        </thead>
        <tbody>
          {% for r in posiciones %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ r.club }}</td>
            <td>{{ r.pts }}</td>
            <td>{{ r.pj }}</td>
            <td>{{ r.pg }}</td>
            <td>{{ r.pe }}</td>
            <td>{{ r.pp }}</td>
            <td>{{ r.gf }}</td>
            <td>{{ r.gc }}</td>
            <td>{{ r.dg }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="muted">No hay posiciones registradas todav√≠a para esta serie.</p>
    {% endif %}
  </section>

  <!-- PANEL DERECHO: NOTICIAS POR SERIE + SANCIONES -->
  <aside class="card">
    <!-- NOTICIAS POR SERIE -->
    <h2>üì∞ Noticias de la serie</h2>

    {% if noticias %}
      {% if serie_sel %}
        <p class="muted" style="margin-top:-4px; margin-bottom:6px;">
          Noticias asociadas a <strong>{{ serie_sel.etiqueta }}</strong>
        </p>
      {% endif %}
      {% for n in noticias %}
        <div class="news-item">
          <div class="news-item-title">{{ n.titulo }}</div>
          <div class="news-meta">
            {% if n.fecha %}{{ n.fecha|date:"d/m/Y" }}{% endif %}
          </div>
          {% if n.resumen %}
            <div class="muted">{{ n.resumen }}</div>
          {% endif %}
        </div>
      {% endfor %}
    {% else %}
      <p class="muted">No hay noticias registradas para esta serie.</p>
    {% endif %}

    <hr style="border-color:#2b3344; margin:12px 0;">

    <!-- SANCIONES DEL TRIBUNAL -->
    <h2>üü• Sanciones del Tribunal</h2>

    {% if sanciones %}
      {% for s in sanciones %}
        <div class="news-item">
          <div class="news-item-title">
            {% if s.tipo %}{{ s.tipo }}{% else %}Sanci√≥n{% endif %}
          </div>
          <div class="news-meta">
            {% if s.fecha_inc %}{{ s.fecha_inc|date:"d/m/Y" }}{% else %}Sin fecha{% endif %}
            {% if s.club %} ¬∑ {{ s.club }}{% endif %}
          </div>
          {% if s.jugador %}
            <div class="muted">Jugador: {{ s.jugador }}</div>
          {% endif %}
          <div>{{ s.motivo }}</div>
        </div>
      {% endfor %}
    {% else %}
      <p class="muted">No hay sanciones registradas por el Tribunal.</p>
    {% endif %}
  </aside>

</div>
{% endblock %}
